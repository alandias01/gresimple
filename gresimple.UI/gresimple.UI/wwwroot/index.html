<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/paginationjs/2.1.3/pagination.css" />
    <link rel="stylesheet"  href="css/loaders.css" />

    <title>Hello, world!</title>

    <style>
        .card-deck {
            margin-bottom: 15px;
        }

        .card {
            max-width: 350px;
            min-height: 150px;
        }

        .cardback {
            display: none;
        }

        #content-gre {
            margin-left: 15px;
            margin-right: 15px;
        }
    </style>
    
</head>
<body>
    <!-- Main Nav Bar-->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">Simple GRE</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Link</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        GRE Lists
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" id="alllist" href="#">All</a>
                        <a class="dropdown-item" id="mylist" href="#">Frankenstein</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Something else here</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link disabled" href="#">Disabled</a>
                </li>
            </ul>
            <form class="form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
            </form>
        </div>
    </nav>
    
    <div id="greloader" class="sk-fading-circle">
        <div class="sk-circle1 sk-circle"></div>
        <div class="sk-circle2 sk-circle"></div>
        <div class="sk-circle3 sk-circle"></div>
        <div class="sk-circle4 sk-circle"></div>
        <div class="sk-circle5 sk-circle"></div>
        <div class="sk-circle6 sk-circle"></div>
        <div class="sk-circle7 sk-circle"></div>
        <div class="sk-circle8 sk-circle"></div>
        <div class="sk-circle9 sk-circle"></div>
        <div class="sk-circle10 sk-circle"></div>
        <div class="sk-circle11 sk-circle"></div>
        <div class="sk-circle12 sk-circle"></div>
    </div>

    <div id="content-gre">
        <br />
        <div id="wordplaceholder"></div>
        <br />

        <div id="paginationbuttons">
            <button id="paginationprev" class="btn"><i class="fas fa-arrow-left"></i></button>
            <button id="paginationnext" class="btn"><i class="fas fa-arrow-right"></i></button>
        </div> 
        <div id="paginationplaceholder"></div>

    </div>        

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paginationjs/2.1.3/pagination.min.js"></script>

    <script>
        
        $(function () {

            //var baseWebApiUrl = "http://localhost:57882/";
            var baseWebApiUrl = "https://gresimplewebapi.azurewebsites.net/";

            var paginationControl = $('#paginationplaceholder');

            $(document).ajaxStart(function () {
                $("#greloader").css("display", "block");
            });

            $(document).ajaxError(function () {
                console.log("Error retrieving data from ajax request")
            });

            $(document).ajaxComplete(function () {
                $("#greloader").css("display", "none");
            });

            $('#alllist').click(function () {
                LoadAll();                
            });

            $('#mylist').click(function () {
                LoadFrankenstein();
            });

            $("#paginationprev").click(function () {
                paginationControl.pagination('previous');
            });

            $("#paginationnext").click(function () {
                paginationControl.pagination('next');
            });

            //wordData = [{ word: "A", def: "ADEF" },
            //{ word: "B", def: "BDEF" },
            //{ word: "C", def: "CDEF" },
            //{ word: "D", def: "DDEF" },
            //{ word: "E", def: "EDEF" },
            //{ word: "F", def: "FDEF" },
            //{ word: "G", def: "GDEF" },
            //{ word: "H", def: "HDEF" },
            //{ word: "I", def: "IDEF" }];
            
            $('#wordplaceholder').append("<div id='wordplaceholder-r1' class='card-deck'></div>");
            $('#wordplaceholder').append("<div id='wordplaceholder-r2' class='card-deck'></div>");
            
            var dataContainer = $('#demodisplay');

            var wordData = [];

            LoadAll();

            function LoadAll() {
                LoadPagination(baseWebApiUrl + "api/grewords");
            }

            function LoadFrankenstein() {
                LoadPagination(baseWebApiUrl + "api/grelistviews");
            }

            function LoadPagination(url) {
                wordData = [];
                
                $.getJSON(url, function (data) {
                    //data.forEach((val, i) => {
                    //    wordData.push(val);
                    //});
                    $.each(data, function (key, val) {
                        wordData.push(val);
                    });
                })
                    .done(function () {
                        console.log("second success");
                        var count = wordData.count;

                        paginationControl.pagination({
                            dataSource: wordData,
                            pageSize: 6,
                            className: 'paginationjs-big',
                            callback: function (data, pagination) {
                                DisplayWords(data);
                            }
                        });
                    })
                    .fail(function () {
                        console.log("error");
                    })
                    .always(function () {
                        console.log("finished");
                    });
            }

            function DisplayWords(wordsToDisplay) {
                $('#wordplaceholder-r1').empty();
                $('#wordplaceholder-r2').empty();

                wordsToDisplay.forEach((w, i) => {

                    var cardTemplate = "<div class='card text-white bg-dark'>" +
                        "<div class='card-body'>" +
                        "<div class='cardfront'>" +
                        "<center><h5 class='card-title'>" + w.word + "</h5></center>" +
                        "</div>" +
                        "<div class='cardback'>" +
                        "<center><h5 class='card-title'>" + w.definition + "</h5></center>" +
                        "</div>" +
                        "</div>" +
                        "</div>";

                    if (i < 3) {
                        $('#wordplaceholder-r1').append(cardTemplate);
                    }
                    else if (i < 6) {
                        $('#wordplaceholder-r2').append(cardTemplate);
                    }
                });

                $('.card').click(function () {
                    $(this).find('.cardfront').toggle();
                    $(this).find('.cardback').toggle();
                });
            }

        });
    </script>
</body>
</html>